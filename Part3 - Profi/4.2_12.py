'''
–í–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ üå∂Ô∏è

–í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω —Ñ–∞–π–ª student_counts.csv, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —É—á–µ–Ω–∏–∫–æ–≤ –≤
–Ω–µ–∫–æ—Ç–æ—Ä–æ–º —É—á–µ–±–Ω–æ–º –∑–∞–≤–µ–¥–µ–Ω–∏–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ 20002000 ‚Äî 20212021 –≥. –í –ø–µ—Ä–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ –∑–∞–ø–∏—Å–∞–Ω –≥–æ–¥,
–≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö –∑–∞–ø–∏—Å–∞–Ω –∫–ª–∞—Å—Å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–Ω–∏–∫–æ–≤ –≤ –¥–∞–Ω–Ω–æ–º –∫–ª–∞—Å—Å–µ –≤ —ç—Ç–æ–º –≥–æ–¥—É:

year,5-–ë,3-–ë,8-–ê,2-–ì,7-–ë,1-–ë,3-–ì,3-–ê,2-–í,6-–ë,6-–ê,8-–ë,8-–ì,11-–ê,2-–ê,7-–ê,5-–ê,2-–ë,10-–ê,11-–ë,8-–í,4-–ê,7-–í,3-–í,1-–ê,9-–ê,11-–í
2000,19,15,18,29,19,17,26,29,28,30,26,27,27,22,29,19,27,20,16,18,15,27,19,29,22,20,23
2001,21,30,22,19,26,20,24,27,20,30,24,30,29,21,20,19,29,27,23,25,30,30,23,22,22,18,22
...

–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –≤ —Ñ–∞–π–ª sorted_student_counts.csv,
—Ä–∞—Å–ø–æ–ª–∞–≥–∞—è –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤, –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∫–ª–∞—Å—Å–æ–≤ ‚Äî –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –±—É–∫–≤.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–º–µ—Ä –∏ –±—É–∫–≤—É –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:

<–Ω–æ–º–µ—Ä –∫–ª–∞—Å—Å–∞>-<–±—É–∫–≤–∞ –∫–ª–∞—Å—Å–∞>

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º –≤ —Ñ–∞–π–ª–µ student_counts.csv —è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—è—Ç–∞—è, –ø—Ä–∏ —ç—Ç–æ–º –∫–∞–≤—ã—á–∫–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 3. –£–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ. –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 4. –ù–∞—á–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å —Ñ–∞–π–ª–∞ sorted_student_counts.csv –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

year,1-–ê,1-–ë,2-–ê,2-–ë,...
2000,22,17,29,20,...
2001,22,20,20,27,...
...

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 5. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ UTF-8.
'''

import csv

with open('student_counts.csv', encoding='utf-8', newline='') as file_in:
    rows = list(csv.reader(file_in))

columns = rows[0]
data = rows[1:]
lib = {} # —Å–≤–µ–¥–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É {{2000: [('5-–ë', 19), ('3-–ë', 15)... 2001: [('5-–ë', 21), ('3-–ë', 30)...}
for line in data:
    for i in range(1, len(line)):
        year = int(line[0])
        if year not in lib:
            lib[year] = [(columns[i], int(line[i]))]
        else:
            lib[year].append((columns[i], int(line[i])))

new = {} # —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ lib
for key, value in lib.items():
    value = sorted(value, key=lambda x: (int(x[0].split('-')[0]), x[0].split('-')[1]))
    new.update({key: dict(value)})

columns = ['year'] + list(dict(value).keys()) # —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

with open('sorted_student_counts.csv', 'w', encoding='utf-8', newline='') as file_out:
    writer = csv.DictWriter(file_out, fieldnames=columns)
    writer.writeheader()  # –∑–∞–ø–∏—Å—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
    for key, value in new.items(): # –∑–∞–ø–∏—Å—å —Å—Ç—Ä–æ–∫
        file_out.write(str(key))
        writer.writerow(value)